var sdf={};(function(e){"use strict";e.fn.serializeObject=function(){var t={};var n=this.serializeArray();e.each(n,function(){if(t[this.name]!==undefined){if(!t[this.name].push){t[this.name]=[t[this.name]]}t[this.name].push(this.value||"")}else{t[this.name]=this.value||""}});return t};e.extend(e.expr[":"],{invalid:function(e,t,n){var r=document.querySelectorAll(":invalid"),i=false,s=r.length;if(s){for(var o=0;o<s;o++){if(e===r[o]){i=true;break}}}return i}});var t={lines:9,length:13,width:7,radius:26,corners:.8,rotate:30,direction:1,color:"#FFF",speed:.7,trail:76,shadow:false,hwaccel:true,className:"spinner",zIndex:2e9,top:"auto",left:"auto"},n=new Spinner(t);sdf.preload=function(){var e=document.createElement("image");e.src="/wp-content/plugins/sdf/img/button-gray-tip-transparent.png"};sdf.stateBlur=function(){e("#state").val(e("#state").val().toUpperCase());e("#cc-state").val(e("#cc-state").val().toUpperCase())};sdf.copyPersonalInfo=function(){if(e(".js-copy-personal-info").prop("checked")){e("#js-cc-fields input").each(function(t,n){e(n).val(e("#"+e(n).attr("name").substr(3)).val()).removeClass("field-error")});e("#js-cc-fields .h5-error-msg").each(function(t,n){e(n).hide()});e("#cc-name").val(e("#first-name").val()+" "+e("#last-name").val());e("#cc-country").val(e("#country").val());e("#js-cc-fields").fadeTo("fast",.5,function(){e("#js-cc-fields input").each(function(t,n){e(n).prop("readonly",true)});e("#cc-country").prop("disabled",true)})}else{e("#js-cc-fields").fadeTo("fast",1,function(){e("#js-cc-fields input").each(function(t,n){e(n).prop("readonly",false)});e("#cc-country").prop("disabled",false)})}};sdf.cc_fields_gray=function(){if(e(".js-copy-personal-info").prop("checked")){e("#js-cc-fields").addClass("faded");e("#js-cc-fields input").each(function(t,n){e(n).prop("readonly",true)});e("#cc-country").prop("disabled",true)}};sdf.futureDate=function(){var t=parseInt(e("#cc-exp-year").val()),n=parseInt(e("#cc-exp-mo").val());if(t<30){t+=2e3}var r=new Date(t,n),i=new Date;i.setHours(0,0,0,0);if(i.getTime()-r.getTime()>0){e("#cc-exp-mo, #cc-exp-year").addClass("field-custom-error")}else{e("#cc-exp-mo, #cc-exp-year").removeClass("field-custom-error")}};sdf.hearAboutChange=function(){var t=e("#hearabout")[0];if(e(t.options[t.selectedIndex]).hasClass("js-select-extra")){e("#js-select-extra-name").html(t.options[t.selectedIndex].value+":");e("#js-select-extra-input").show()}else{e("#hearabout-extra").val("");e("#js-select-extra-input").hide()}};sdf.doSubmit=function(){var t=e("#sdf_form form")[0];if(t.checkValidity()){e("body").append('<div id="loading"></div>');n.spin(document.getElementById("loading"));var r={number:e("#cc-number").val(),cvc:e("#cc-cvc").val(),exp_month:e("#cc-exp-mo").val(),exp_year:e("#cc-exp-year").val(),name:e("#cc-name").val(),address_line1:e("#cc-address1").val(),address_line2:e("#cc-address2").val(),address_city:e("#cc-city").val(),address_state:e("#cc-state").val(),address_zip:e("#cc-zip").val(),address_country:e("#cc-country").val()};Stripe.card.createToken(r,sdf.stripeResponseHandler);e("a#js-form-submit").addClass("disabled").parent().find("img").prop("src","/wp-content/plugins/sdf/img/button-gray-tip-transparent.png")}else{e("#sdf_form input:invalid").each(function(t,n){e(n).addClass("field-error")})}};sdf.clear_notification=function(t){if(t===0){e(".alert p").first().remove()}else{t=t||5e3;setTimeout(function(){e(".alert p").first().fadeTo("fast",0,function(){e(this).animate({height:0},"fast").remove()})},t)}};sdf.clear_loading=function(){n.stop();e("#loading").remove()};sdf.redirect=function(){window.location.href=window.location.protocol+"//"+window.location.hostname+"/donation-confirmation/"};sdf.stripeResponseHandler=function(t,n){var r={};n=typeof n!=="undefined"?n:{};if(n.error){sdf.clear_notification(0);e(".alert").append('<p class="error">'+n.error.message+"</p>");document.getElementsByClassName("alert")[0].scrollIntoView();sdf.clear_loading();sdf.re_enable()}else{e("#stripe-token").val(n.id);r=e("#sdf_form form").serializeObject();e.each(r,function(e,t){if(e.substring(0,3)==="cc-"){delete r[e]}});e.post(ajaxurl,{action:"sdf_parse",data:r},function(t){sdf.clear_loading();sdf.clear_notification(0);t=JSON.parse(t);e(".alert").append('<p class="'+t.type+'">'+t.message+"</p>").show();document.getElementsByClassName("alert")[0].scrollIntoView();if(t.type=="error"){sdf.re_enable()}else{setTimeout(sdf.redirect,2500)}})}};sdf.re_enable=function(){e("a#js-form-submit").removeClass("disabled").parent().find("img").prop("src","/img/button-dark-tip.png")};sdf.custom_amount_create=function(t){t=t||{};var n=t.target;if(e(n).is("#js-custom-input, #amount-text")||e.contains(n,document.getElementById("js-custom-input"))){return true}else{sdf.custom_amount_remove()}var r=document.createElement("input");r.name=e(n).attr("for");r.placeholder="Custom amount";r.pattern="^[$]?\\d+([.]\\d{2})?$";r.required=true;r.type="text";r.id="js-custom-input";r.dataset.h5Errorid="invalid-"+r.name;e(n).html(r).addClass("custom-label-input");setTimeout(function(){e(r).focus()},0)};sdf.custom_amount_remove=function(){var t=e("#js-custom-input");if(t.length){var n=t.prop("placeholder");t.parent("label").empty().removeClass("custom-label-active custom-label-input").text(n);e("#invalid-"+t.attr("name")).hide()}e("#sdf_form").off("click",".custom-label").on("click",".custom-label",sdf.custom_amount_create)};sdf.custom_amount_blur=function(){var t=e("#js-custom-input"),n=t.val(),r=t.parent("label");if(!n.length){var i=e(sdf.clicked).hasClass("selected"),s=!e(sdf.clicked).is("label.button-look");if(i||s){return false}else{}}if(t.is(":invalid")){return false}if(n.length){if(n.substr(0,1)!=="$"){n="$"+n}if(n.indexOf(".")!=-1){var o=n.split(".");if(o[1].length==0){o[1]+="00"}else if(o[1].length==1){o[1]+="0"}n=o[0]+"."+o[1]}t.prop("type","hidden");if(e("#amount-text").length){e("#amount-text").text(n)}else{r.append('<span id="amount-text">'+n+"</span>")}r.removeClass("custom-label-input").addClass("custom-label-active")}};sdf.custom_amount_focus=function(){e("#amount-text").remove();if(e("#amount-text").length){e("#amount-text").remove()}e("#js-custom-input").parent("label").addClass("custom-label-input");e("#js-custom-input").prop("type","text");setTimeout(function(){e("#js-custom-input").focus()},0)};sdf.radio_change=function(t){var n=false,t=t||{};if(!("target"in t)){t.target=sdf.clicked}var r=e(t.target).next("label"),i=e(".selected").hasClass("custom-label");if(i){var s=!r.hasClass("custom-label");if(s){n=true}}if(n){sdf.custom_amount_remove()}if(e(t.target).hasClass("custom-label")){sdf.custom_amount_create(t)}e("label.button-look").removeClass("selected");e(".amount:checked").next("label").addClass("selected")};sdf.custom_keys=function(e){var t=e.which||e.keyCode;if(t==13){sdf.custom_amount_blur()}};e(document).mousedown(function(e){sdf.clicked=e.target});e(document).ready(function(){sdf.cc_fields_gray();sdf.preload();e("#sdf_form").on("blur","#js-custom-input",sdf.custom_amount_blur).on("click",".custom-label-active",sdf.custom_amount_focus).on("click",".custom-label",sdf.custom_amount_create).on("keydown","#js-custom-input",sdf.custom_keys);e(".amount").change(sdf.radio_change);e("#hearabout").change(sdf.hearAboutChange);e("#state, #cc-state").blur(sdf.stateBlur);e("#copy-personal-info").click(sdf.copyPersonalInfo);e("a#js-form-submit.disabled").on("click",function(){return false});e("#sdf_form form").h5Validate({errorClass:"field-error"});e("#cc-exp-year").on("focusout",sdf.futureDate);e("#js-form-submit").click(sdf.doSubmit)})})(jQuery)